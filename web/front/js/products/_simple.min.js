
$(document).ready(function()
{function spaceBottom(){if($('#action').css('position')=='fixed')$("footer").css("margin-bottom",$('#action').outerHeight());else $("footer").css("margin-bottom",0);}
spaceBottom();$(window).resize(spaceBottom);moment.locale(locale);var promotionTimeLeft;getVariation();var galleryTop=new Swiper(".gallery-top",{pagination:$(".gallery-top .swiper-pagination"),spaceBetween:10,paginationClickable:true,slidesPerView:1,onTransitionStart:function(swiper){$(".thumbs .thumb").eq(swiper.activeIndex).addClass("active").siblings().removeClass("active");},onClick:function(swiper,event){$("body").toggleClass("gallery-fullscreen-visible");galleryTop.update(true);$(".thumbs .active").click();},});$(".thumbs").on("click",".thumb",function(e){galleryTop.slideTo($(this).index());});$("#gallery .close").on("click",function(e){$("body").removeClass("gallery-fullscreen-visible");onmousestop;galleryTop.update(true);$(".thumbs .active").click();});var thumbsTimer;$('html').on("mousemove",".gallery-fullscreen-visible .gallery-top",function(e){$('.gallery-fullscreen-visible .thumbs').addClass('show');clearTimeout(thumbsTimer);thumbsTimer=setTimeout(onmousestop,1500);});$('html').on("mousemove",".gallery-fullscreen-visible .thumbs",function(e){$('.gallery-fullscreen-visible .thumbs').addClass('show');clearTimeout(thumbsTimer);});var onmousestop=function(){$('.gallery-fullscreen-visible .thumbs').removeClass('show');};loadGallery();var accessoriesSwiper=$("#accessories .swiper-container").swiper({nextButton:$("#accessories .swiper-button-next"),prevButton:$("#accessories .swiper-button-prev"),pagination:$("#accessories .swiper-pagination"),paginationClickable:true,spaceBetween:0,slidesPerView:3,breakpoints:{1240:{slidesPerView:2},991:{slidesPerView:3},767:{slidesPerView:2},480:{slidesPerView:1}}});$('#accessories').on("click","button",function(e){if($(this).hasClass('disabled'))return;$(this).toggleClass('active');getVariation();});$('#action .add-to-cart').click(function(e){window.location.href=$(this).data('url');});function getVariation(){var accessories=$('#accessories .active').length;var accessoriesCount="";var accessoriesIds="";var accessoriesTotalPrice=0;if(accessories){$('#accessories .active').each(function(){accessoriesTotalPrice+=$(this).data('price');accessoriesIds+="|"+$(this).data('id');});accessoriesCount='<span class="accessories"> + '+accessories+' '+$('#accessories').data("title")+'</span>';}
var variation=$('#products>div');$("#variation .title").html(variation.data("title")+accessoriesCount);var promotion=variation.data().hasOwnProperty("promotion")?variation.data("promotion"):false;if(promotion){$("#variation .promotion").html("<span>"+promotion+"%</span>"+$("#variation .promotion").data("until-txt")+" <strong>"+variation.data("until")+"</strong>");$("#price").html(((variation.data("price")*(100-promotion)/100)+accessoriesTotalPrice).formatMoney(0,"."," ")+" "+currency+"<br><span>"+$("#price").data("rather-than")+" "+(variation.data("price")+accessoriesTotalPrice).formatMoney(0,"."," ")+" "+currency+"</span>");(function updatePromotionTimeLeft(){$("#variation .promotion strong").text(moment(variation.data("until")).fromNow());promotionTimeLeft=setTimeout(updatePromotionTimeLeft,1000);})();}else{$("#variation .promotion").empty();$("#price").text((variation.data("price")+accessoriesTotalPrice).formatMoney(0,"."," ")+" "+currency);}
$("#availability").toggleClass("available",variation.data("available")=="available");$("#availability").toggleClass("on-demand",variation.data("available")=="onDemand");$("#availability").toggleClass("unavailable",!variation.data("available"));$(".add-to-cart").toggleClass("disabled",!variation.data("available"));$(".add-to-cart").data("id",variation.data("id")+accessoriesIds);$(".add-to-cart").data("url",variation.data("url"));var animationName="animated quickShake";var animationEnd="webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend";$("#availability.unavailable").addClass(animationName).one(animationEnd,function(){$(this).removeClass(animationName)});}
function loadGallery(){galleryTop.removeAllSlides();var thumbs=$(".thumbs>div");thumbs.children().each(function(){galleryTop.appendSlide('<div class="swiper-slide"><img src="'+$(this).children().data("src")+'"/></div>');});thumbs.children().first().addClass("active").siblings().removeClass("active");thumbs.addClass('active').siblings().removeClass('active');var animationName="animated fadeIn";var animationEnd="webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend";$("#gallery").addClass(animationName).one(animationEnd,function(){$(this).removeClass(animationName)});}});